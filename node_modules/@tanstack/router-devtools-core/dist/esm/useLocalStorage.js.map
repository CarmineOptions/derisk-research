{"version":3,"file":"useLocalStorage.js","sources":["../../src/useLocalStorage.ts"],"sourcesContent":["import { createEffect, createSignal } from 'solid-js'\nimport type { Accessor } from 'solid-js'\n\nconst getItem = (key: string): unknown => {\n  try {\n    const itemValue = localStorage.getItem(key)\n    if (typeof itemValue === 'string') {\n      return JSON.parse(itemValue)\n    }\n    return undefined\n  } catch {\n    return undefined\n  }\n}\n\nexport default function useLocalStorage<T>(\n  key: string,\n  defaultValue: T | undefined,\n): [Accessor<T | undefined>, (newVal: T | ((prevVal: T) => T)) => void] {\n  const [value, setValue] = createSignal<T>()\n\n  createEffect(() => {\n    const initialValue = getItem(key) as T | undefined\n\n    if (typeof initialValue === 'undefined' || initialValue === null) {\n      setValue(\n        typeof defaultValue === 'function' ? defaultValue() : defaultValue,\n      )\n    } else {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      setValue(initialValue)\n    }\n  })\n\n  const setter = (updater: any) => {\n    setValue((old) => {\n      let newVal = updater\n\n      if (typeof updater == 'function') {\n        newVal = updater(old)\n      }\n      try {\n        localStorage.setItem(key, JSON.stringify(newVal))\n      } catch {}\n\n      return newVal\n    })\n  }\n\n  return [value, setter]\n}\n"],"names":[],"mappings":";AAGA,MAAM,UAAU,CAAC,QAAyB;AACpC,MAAA;AACI,UAAA,YAAY,aAAa,QAAQ,GAAG;AACtC,QAAA,OAAO,cAAc,UAAU;AAC1B,aAAA,KAAK,MAAM,SAAS;AAAA,IAAA;AAEtB,WAAA;AAAA,EAAA,QACD;AACC,WAAA;AAAA,EAAA;AAEX;AAEwB,SAAA,gBACtB,KACA,cACsE;AACtE,QAAM,CAAC,OAAO,QAAQ,IAAI,aAAgB;AAE1C,eAAa,MAAM;AACX,UAAA,eAAe,QAAQ,GAAG;AAEhC,QAAI,OAAO,iBAAiB,eAAe,iBAAiB,MAAM;AAChE;AAAA,QACE,OAAO,iBAAiB,aAAa,iBAAiB;AAAA,MACxD;AAAA,IAAA,OACK;AAGL,eAAS,YAAY;AAAA,IAAA;AAAA,EACvB,CACD;AAEK,QAAA,SAAS,CAAC,YAAiB;AAC/B,aAAS,CAAC,QAAQ;AAChB,UAAI,SAAS;AAET,UAAA,OAAO,WAAW,YAAY;AAChC,iBAAS,QAAQ,GAAG;AAAA,MAAA;AAElB,UAAA;AACF,qBAAa,QAAQ,KAAK,KAAK,UAAU,MAAM,CAAC;AAAA,MAAA,QAC1C;AAAA,MAAA;AAED,aAAA;AAAA,IAAA,CACR;AAAA,EACH;AAEO,SAAA,CAAC,OAAO,MAAM;AACvB;"}